<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noindex, nofollow">
        <title>Präsentation</title>

        <link rel='icon' type='image/png' href='/favicon.png'>
        <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap@4.3.1/dist/css/bootstrap.min.css" />

        <style>
            /* praizee-demo { display: none; } */
        </style>
        <!-- <script type="module" src="./components/demo.js"></script> -->
        <script type="module" src="./components/praizee.js"></script>

    </head>
    <body>
        <div class="container p-3 text-white">
            <div class="row">
                <div class="col">
                  <praizee-demo start="0" title="Web Components" logo="./res/Logo_Digitas_Pixelpark_horizontal_4c_black.png">## Was ist das?

> Webkomponenten sind eine Gruppe von Funktionen, die ein Standardkomponentenmodell für das Web bereitstellen und die Kapselung und Interoperabilität einzelner HTML-Elemente ermöglichen.

## Was kann man damit machen?

```
<h1></h1>
```

## Was kann man damit machen?

```
<img src="" />
```

## Was kann man damit machen?

```
<cookie-banner confirm="/confirm/cookies">
    <h1>Kekse essen wir</h1>
    <p>Mampf, mampf. Hmmmh... lecker! <a href="/kekse">Mehr Infos</a></p>
</cookie-banner>
```

## Geschichte

- ursprünglich 2011 auf der [Fronteers Conference](https://fronteers.nl/congres/2011/sessions/web-components-and-model-driven-views-alex-russell) eingeführt
- in letzten Jahren eng mit Polymer verknüpft
- Vergleich mit Frameworks wird [diskutiert](https://dev.to/richharris/why-i-don-t-use-web-components-2cia)
- inzwischen aber in den meisten aktuellen Browsern angekommen
- veralteter Browser wird über JS-Polyfills unterstützt

## Vorteile von Web Components

1. durch eigenen Scope unabhängiges und stabiles Layout
2. universell einsetzbar (SSR, JS, Vue, GTM, A/B)
3. lassen sich wie natürliche HTML-Elemente verwenden

## Integration

```
<cookie-banner confirm="/confirm/cookies" modification="darkmode" closeable fullscreen local-storage="cookie-confirmation">
    <h1>Kekse essen wir</h1>
    <p>Mampf, mampf. Hmmmh... lecker! <a href="/kekse">Mehr Infos</a></p>
    <button>Okay</button>
</cookie-banner>
```

Daten an die Komponente übergeben:

- Attribute als String oder Boolean
- inneres HTML zur Befüllung eines (oder mehrerer) Slots

## Integration

```
<cookie-banner
    some-more-data="`${JSON.stringify({button:"OK", closeable:true})}`"
    >
    <h1 slot="headline"></h1>
    ...
    <button slot="buttons"></button>
</cookie-banner>
```

Daten an die Komponente übergeben:

- Attribute als String oder Boolean
- inneres HTML zur Befüllung eines (oder mehrerer) Slots

## Integration

Interaktion mit JavaScript...

```
document.querySelector('cookie-banner')
    // Attribute setzen
    setAttribute('modification', 'default')
    // custom events
    .addEventListener('confirmed', e => {
        if (e.target.hasAttribute('fullscreen')) {
            e.target.removeAttribute('fullscreen')
        }
    })
```

## Technische Grundlagen

- ***Custom Elements:*** API um eigene HTML Elemente zu schreiben oder bestehende zu erweitern
- ***Shadow DOM:*** gekapseltes unabhängiges DOM, scoped CSS ermöglicht risikofreies Styling
- ***HTML Templates:*** mit `<template>` Element HTML Vorlagen erstellen und im DOM hinterlegen, mit JS manipulieren und nutzen

## Native HTML Elemente erweitern

```
class OkButton extends HTMLButtonElement {
    constructor() {
        super()
        this.addEventListener('click', e => this.clickHandler(e.offsetX, e.offsetY))
    }

    clickHandler(x, y) {
        console.log('click handler:', x, y)
    }
}

customElements.define('ok-button', OkButton, {extends: 'button'})
```

## Native HTML Elemente erweitern

```
<button is="ok-button" class="p-4" onclick="console.log('button click');">OK</button>
```

<script>
class OkButton extends HTMLButtonElement {
    constructor() {
        super()
        this.addEventListener('click', e => this.clickHandler(e.offsetX, e.offsetY))
    }

    clickHandler(x, y) {
        console.log('click handler:', x, y)
    }
}

customElements.define('ok-button', OkButton, {extends: 'button'})
</script>

<button is="ok-button" class="p-4" onclick="console.log('button click');">OK</button>

## Eigenständige Elemente erstellen

```
CookieBanner extends HTMLElement {
    constructor() {
        super();
    }
}

window.customElements.define("cookie-banner", CookieBanner);
```

## Eigenständige Elemente erstellen

```
CookieBanner extends HTMLElement {
    constructor() {
        super();
    }

    connectedCallback() {}      // element added to DOM
    disconnectedCallback() {}   // element removed from DOM
    adoptedCallback() {}        // element moved inside of DOM

    static get observedAttributes() {
        // list of attributes to be watched
        return ["title"];
    }

    attributeChangedCallback(name, oldVal, newVal) {
        // some attribute has changed
    }
}

window.customElements.define("cookie-banner", CookieBanner);
```


## Shadow DOM

```
CookieBanner extends HTMLElement {
    constructor() {
        super();

        const template = document.createElement("template");
        template.innerHTML = `<style>:host { position: fixed; }</style><div><h1>Cookies</h1><slot name="buttons"></slot></div>`;

        this.attachShadow({ mode: "open" });
        this.shadowRoot.appendChild(template.content.cloneNode(true));
        this.headline = this.shadowRoot.querySelector('h1');
    }

    connectedCallback() {
        this.headline.textContent = this.getAttribute("headline");
    }
}
```

## Implementierung

... [ein Beispiel](./example/index.html) ...

## Custom Elements erweitern

```
SuperCookieBanner extends CookieBanner {
    constructor() {
        super();
    }
}

window.customElements.define("super-cookie-banner", SuperCookieBanner);
```

z.B. für A/B-Tests etc.

## Hilfsmittel

Einige Libraries wollen helfen, den Abstraktionslevel für custom elements zu erhöhen:

- Polymer, LitElement
- Slim.js, X-Tag
- Angular, React, Svelte, Vue

## Hilfsmittel?

- langfristiges Projekt?
- keine Bindung an Frameworks oder Bibliotheken erwünscht?

> **⟿ nativ implementierte Web Components in Erwägung ziehen**

> **⟿ progressive Lösungsansätze als Alternative zu IE11-Polyfills prüfen**


## Design Systeme

Web Components sind mit Design Systemen gut vereinbar.
Können z.B. mit Storybook oder Fractal leicht entwickelt (Workbench) und dokumentiert (Shop) werden:

- Wie erfolgt Integration?
- Welche Attribute vorhanden?
- Welche Slots?
- Welche Event-Listener zur Kommunikation nach außen?

> Verwendung mit einem Design System daher ist empfehlenswert, insbesondere bei Projekten mit Microfrontend-Architektur.

##

                  </praizee-demo>
                    <!-- <roller-demo
                        button="OK"
                        confirmation=" ausgewählt. Diesen Eintrag löschen?"
                        title="Einkäufe"
                        favorites='["Milch","Zucker", "Quark"]'
                        image="https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-1252/angebotskueche-1279000302-teaser.jpg"
                        >
                        <small>Einkaufsliste im eigenen Browser verwalten.</small>
                    </roller-demo> -->
                </div>
            </div>
        </div>
    </body>
</html>